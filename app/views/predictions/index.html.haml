= stylesheet_link_tag 'prediction'
= javascript_include_tag :defaults
= sprocket_include_tag 'backcasting'

.prediction
  .intro
    Hier kun je jouw scenario vergelijken met verwachtingen van experts. Jouw scenario valt binnen/buiten de expertverwachtingen. Deze verwachtingen zijn gebaseerd op een aantal maatregelen. Hoe denk jij dat de adoptie van elektrische autoâ€™s zal verlopen?
  .slider_title= @input_element.name
  .upper_block
    .chart#backcasting
    .available_predictions
      - @input_element.predictions.each do |p|
        .item
          = radio_button_tag :prediction_id, p.id, (p.id == @prediction.id)
          .color
          .label
            #{p.user.try(:name)}, 
            = p.title
            - if v = p.last_value
              (#{v.value} in #{v.year})
  .prediction_details
    = render @prediction

:javascript
  $(function(){
    // ajax loading of prediction details
    $("input[type=radio]").click(function(){
      var prediction_id = $(this).val();
      var url = "/predictions/" + prediction_id;
      console.log("Loading" + url);
      $(".prediction_details").load(url);
    });
    
    //charts
    $.jqplot("backcasting", #{@input_element.predictions.map{|p| p.values_to_a}.to_json}
    );
  });