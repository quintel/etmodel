/**
 * Pavlov - Behavioral API over QUnit
 * 
 * version 0.2.3
 * 
 * http://michaelmonteleone.net/projects/pavlov
 * http://github.com/mmonteleone/pavlov
 *
 * Copyright (c) 2009 Michael Monteleone
 * Licensed under terms of the MIT License (README.markdown)
 */
(function(){var r=this;var h=function(a,b){var c;var d=0;var g=a.length;if(g===undefined){for(c in a){if(b.call(a[c],c,a[c])===false){break}}}else{for(var f=a[0];d<g&&b.call(f,d,f)!==false;f=a[++d]){}}return a};var n=function(a){var b=[];var c=a.length;while(c){b[--c]=a[c]}return b};var s=function(a){return Object.prototype.toString.call(a)==="[object Array]"};var k=function(a,b){for(var c in b){a[c]=b[c]}};var t=function(a,b,c){if(a.addEventListener){a.addEventListener(b,c,false)}else if(a.attachEvent){a.attachEvent("on"+b,c)}};var l=[];var i;function u(d){if(d){d.children.push(this)}else{l.push(this)}var g=this;var f=function(a){var b=[];var c=g;while(c!==null){b.push(c[a]);c=c.parent}return b};this.parent=d?d:null;this.children=[];this.name='';this.before=function(){};this.after=function(){};this.specs=[];this.befores=function(){return f('before').reverse()};this.afters=function(){return f('after')};this.names=function(){return f('name').reverse().join(', ')}}var v={equals:function(a,b,c){equals(a,b,c)},isEqualTo:function(a,b,c){equals(a,b,c)},isNotEqualTo:function(a,b,c){ok(a!==b,c)},isSameAs:function(a,b,c){same(a,b,c)},isNotSameAs:function(a,b,c){ok(!QUnit.equiv(a,b),c)},isTrue:function(a,b){ok(a,b)},isFalse:function(a,b){ok(!a,b)},isNull:function(a,b){ok(a===null,b)},isNotNull:function(a,b){ok(a!==null,b)},isDefined:function(a,b){ok(typeof(a)!=='undefined',b)},isUndefined:function(a,b){ok(typeof(a)==='undefined',b)},pass:function(a,b){ok(true,b)},fail:function(a,b){ok(!true,b)},throwsException:function(a,b,c){try{a();ok(!true,c)}catch(e){if(arguments.length>1){ok(e===b,c)}else{ok(true,c)}}}};var j=function(a){this.value=a};var o=function(d){h(d,function(b,c){j.prototype[b]=function(){var a=n(arguments);a.unshift(this.value);c.apply(this,a)}})};o(v);var m={describe:function(a,b){if(arguments.length<2){throw("both 'description' and 'fn' arguments are required");}var c=i;try{i=new u(i);i.name=a;b()}finally{i=c}},before:function(a){if(arguments.length===0){throw("'fn' argument is required");}i.before=a},after:function(a){if(arguments.length===0){throw("'fn' argument is required");}i.after=a},it:function(a,b){if(arguments.length===0){throw("'specification' argument is required");}thisApi=this;if(b){i.specs.push([a,b])}else{thisApi.it(a,function(){thisApi.assert.fail('Not Implemented')})}},given:function(){if(arguments.length===0){throw("at least one argument is required");}var d=n(arguments);var g=this.it;return{it:function(b,c){h(d,function(){var a=this;g("given "+a+", "+b,function(){c.apply(this,s(a)?a:[a])})})}}},assert:function(a){return new j(a)},wait:function(a,b){if(arguments.length<2){throw("both 'ms' and 'fn' arguments are required");}stop();QUnit.specify.globalObject.setTimeout(function(){b();start()},a)}};k(m.assert,{pass:function(a){(new j()).pass(a)},fail:function(a){(new j()).fail(a)}});var w=function(b,c,d){var g=b.toString().match(/\(([^\)]*)\)/)[1];var f=b.toString().match(/^[^\{]*\{((.*\n*)*)\}/m)[1];b=new Function("extraScope"+(g?", "+g:""),"with(extraScope){"+f+"}");return function(){var a=[d];h(arguments,function(){a.push(this)});b.apply(c,a)}};var p=function(b,c){if(arguments.length<2){throw("both 'name' and 'fn' arguments are required")}l=[];i=null;document.title=b+" Specifications";t(window,'load',function(){var a=document.getElementsByTagName('h1');if(a.length>0)a[0].innerHTML=document.title});if(QUnit.specify.globalApi){k(r,m);c()}else{w(c,this,m)()}var d=x(l);h(d,function(){this()})};var x=function(g){var f=[];var q=function(b){var c=b.befores();var d=b.afters();f.push(function(){module(b.names(),{setup:function(){h(c,function(){this()})},teardown:function(){h(d,function(){this()})}})});h(b.specs,function(){var a=this;f.push(function(){test(a[0],a[1])})});h(b.children,function(){q(this)})};h(g,function(){q(this,f)});return f};QUnit.specify=p;k(p,{version:'0.2.3',globalApi:false,extendAssertions:o,globalObject:window})})();